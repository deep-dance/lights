(function(t){function e(e){for(var s,i,o=e[0],f=e[1],c=e[2],u=0,d=[];u<o.length;u++)i=o[u],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&d.push(r[i][0]),r[i]=0;for(s in f)Object.prototype.hasOwnProperty.call(f,s)&&(t[s]=f[s]);l&&l(e);while(d.length)d.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],s=!0,o=1;o<n.length;o++){var f=n[o];0!==r[f]&&(s=!1)}s&&(a.splice(e--,1),t=i(i.s=n[0]))}return t}var s={},r={app:0},a=[];function i(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=s,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],f=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var l=f;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},"060d":function(t,e,n){},"0796":function(t,e,n){},1:function(t,e){},2:function(t,e){},"383a":function(t,e,n){"use strict";n("ff71")},"41f3":function(t,e,n){"use strict";n("f884")},"4ab9":function(t,e,n){"use strict";n("060d")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{staticClass:"content"},[n("div",{staticClass:"v-spacer-large"}),n("h1",[t._v("led-controller "),n("ServerStatus")],1)]),n("div",{staticClass:"content"},[n("DMXSender")],1),n("div",{staticClass:"content"},[n("h5",[t._v("Sequence")]),n("ControlBar"),n("Upload",{attrs:{dataKey:"red"}})],1)])},a=[],i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"playhead"}},[null!=this.$store.state.currentJSONData["red"]?n("div",{attrs:{id:"controlBar"}},[this.$store.state.isPlaying?t._e():n("PlayIcon",{staticClass:"icon",on:{click:function(e){return t.StartAnimation()}}}),this.$store.state.isPlaying?n("PauseIcon",{staticClass:"icon",on:{click:function(e){return t.PauseAnimation()}}}):t._e(),n("ProgressBar"),n("div",{staticClass:"minutes-control"},[n("div",{staticClass:"minutes"},[t._v(" "+t._s(this.convertFrameToTime(this.$store.state.currentFrame))+" / "+t._s(this.convertFrameToTime(25*Object.keys(this.$store.state.currentJSONData["red"].positions).length))+" ")]),n("input",{ref:"timeInput",attrs:{value:"",type:"text",placeholder:"mm:ss"},on:{change:t.SetTime}})])],1):t._e()])},o=[],f=(n("b64b"),n("4d63"),n("ac1f"),n("25f0"),n("1276"),n("6e49")),c=n.n(f),l=n("f87c"),u=n.n(l),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"progressbar",attrs:{id:"progressbar-outer"},on:{click:t.SetFrame}},[n("div",{staticClass:"progressbar-inner",class:{active:this.$store.state.isPlaying},style:{width:t.progressWidth+"px"}})])},h=[],m={name:"ProgressBar",components:{},computed:{currentClipLength:function(){return Object.keys(this.$store.state.currentJSONData["red"].positions).length*this.$store.state.fps},progressWidth:function(){var t=this.$store.state.currentFrame,e=this.$refs.progressbar?this.$refs.progressbar.clientWidth:500;return e*t/this.currentClipLength}},methods:{SetFrame:function(t){var e=t.clientX-this.$refs.progressbar.getBoundingClientRect().left,n=this.$refs.progressbar.clientWidth,s=Math.round(this.currentClipLength*e/n);console.log("progress",s),this.$store.commit("SetCurrentFrame",s)}},mounted:function(){}},p=m,v=(n("aa09"),n("2877")),b=Object(v["a"])(p,d,h,!1,null,null,null),g=b.exports,S={name:"App",components:{PlayIcon:c.a,PauseIcon:u.a,ProgressBar:g},data:function(){return{frameIdx:0}},methods:{alertInvalid:function(){alert("Please use a valid timestamp, e.g 13:12."),this.$refs.timeInput.value=""},alertOutOfRange:function(){alert("Timestamp is after end of sequence."),this.$refs.timeInput.value=""},SetTime:function(){var t=this.$refs.timeInput.value,e=new RegExp("[0-9][0-9]*:([0-9][0-9]){1}");if(e.test(t)){var n=t.split(":"),s=parseInt(n[0]),r=parseInt(n[1]);if(s<0||r<0||r>59)this.alertInvalid();else{var a=60*s+r,i=a*this.$store.state.fps,o=Object.keys(this.$store.state.currentJSONData["red"].positions).length*this.$store.state.fps;i>o?this.alertOutOfRange():this.$store.commit("SetCurrentFrame",i)}}else this.alertInvalid()},StartAnimation:function(){this.$store.commit("SetAnimationStatus",!0)},PauseAnimation:function(){this.$store.commit("SetAnimationStatus",!1)},mapSeconds:function(t,e,n,s,r){return(t-e)*(r-s)/(n-e)+s},convertFrameToTime:function(t){var e=Math.round(t/this.$store.state.fps/60*100)/100,n=Math.floor(e),s=Math.ceil(this.mapSeconds(e%1,0,.99999,0,59));return n+":"+(s<10?"0"+s:s)},convertTimeToFrame:function(t,e){return 0}},mounted:function(){}},y=S,$=(n("ff2b"),Object(v["a"])(y,i,o,!1,null,"1b5a8326",null)),w=$.exports,O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"upload",attrs:{id:"json-upload"}},[n("div",{staticClass:"frames"},[t._v(" "+t._s(this.$store.state.filename[this.dataKey].toString()?this.$store.state.filename[this.dataKey]:"No file selected...")+" ")]),n("label",{class:"btn btn-primary custom-file-upload left "+this.dataKey,attrs:{for:"json-file-upload"+this.dataKey}},[n("i",{staticClass:"fa fa-cloud-upload"}),t._v("⮍ ")]),n("input",{attrs:{type:"file",id:"json-file-upload"+this.dataKey,value:"Import"},on:{change:t.onFileChange}}),n("br")])},C=[],x=(n("b0c0"),{name:"Upload",props:["dataKey"],components:{},methods:{onFileChange:function(t){var e=t.target.files||t.dataTransfer.files,n=new FileReader;n.onload=this.onReaderLoad,n.readAsText(e[0]),this.$store.commit("SetCurrentFilename",{data:e[0].name,key:this.dataKey})},onReaderLoad:function(t){var e=JSON.parse(t.target.result);this.$store.commit("SetJSONData",{data:e,key:this.dataKey})}}}),_=x,D=(n("41f3"),Object(v["a"])(_,O,C,!1,null,null,null)),M=D.exports,A=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"dmx-sender"}},[n("h5",[t._v("Direct")]),n("b-button",{staticClass:"mt-2 left",class:{btn_active:this.$store.state.dmxActive},attrs:{variant:"primary"},on:{click:function(e){return t.directOff()}}},[t._v("Off")]),n("b-button",{staticClass:"mt-2 left",class:{btn_active:this.$store.state.dmxActive},attrs:{variant:"primary"},on:{click:function(e){return t.directWhite()}}},[t._v("White")])],1)},P=[],j=n("e3c1"),k=j["a"],F=(n("383a"),Object(v["a"])(k,A,P,!1,null,null,null)),T=F.exports,E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"server-status"}},[n("div",{class:{connected:this.$store.state.dmxConnected,disconnected:!this.$store.state.dmxConnected},attrs:{id:"server-status-icon"}})])},I=[],R=n("2f62");s["default"].use(R["a"]);new R["a"].Store({state:{}});var J={name:"ServerStatus",components:{},methods:{},mounted:function(){}},N=J,L=(n("4ab9"),Object(v["a"])(N,E,I,!1,null,null,null)),q=L.exports,B={name:"App",components:{ServerStatus:q,ControlBar:w,Upload:M,DMXSender:T},methods:{toogleSlowMo:function(){this.$store.commit("SetSlowMo",!this.$store.state.slowMo)},pressedEnter:function(){alert("You pressed the Enter key!")}},mounted:function(){}},H=B,W=(n("034f"),Object(v["a"])(H,r,a,!1,null,null,null)),X=W.exports;s["default"].use(R["a"]);var K=new R["a"].Store({state:{currentJSONData:{red:null},currentFrame:0,isPlaying:!1,filename:{red:""},dmxActive:!0,addMinVal:!0,slowMo:!0,fps:25,interval:.04,leds_lru:[],dmxConnected:!0},mutations:{SetJSONData:function(t,e){t.currentJSONData[e.key]=e.data},SetAnimationStatus:function(t,e){t.isPlaying=e},SetCurrentFrame:function(t,e){t.currentFrame=e},SetCurrentFilename:function(t,e){t.filename[e.key]=e.data},SetDMXActive:function(t,e){t.dmxActive=e},SetSlowMo:function(t,e){t.slowMo=e},SetLedsLRU:function(t,e){t.leds_lru=e},SetDMXConnected:function(t,e){t.dmxConnected=e}}}),U=n("5f5b"),V=n("b1e0");n("f9e3"),n("2dd8");s["default"].use(U["a"]),s["default"].use(V["a"]),s["default"].config.productionTip=!1,new s["default"]({store:K,render:function(t){return t(X)}}).$mount("#app")},"6e49":function(t,e){t.exports={functional:!0,render(t,e){const{_c:n,_v:s,data:r,children:a=[]}=e,{class:i,staticClass:o,style:f,staticStyle:c,attrs:l={},...u}=r;return n("svg",{class:[i,o],style:[f,c],attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 496.158 496.158"},l),...u},a.concat([n("path",{attrs:{d:"M496.158 248.085C496.158 111.064 385.088.003 248.082.003 111.07.002 0 111.062 0 248.085c0 137.002 111.07 248.071 248.083 248.071 137.005-.001 248.075-111.07 248.075-248.071z",fill:"#32bea6"}}),n("path",{attrs:{d:"M370.805 235.242L195.856 127.818c-4.776-2.934-11.061-3.061-15.951-.322a15.784 15.784 0 00-8.071 13.762v214a15.794 15.794 0 008.046 13.752 15.824 15.824 0 007.725 2.02c2.897 0 5.734-.797 8.205-2.303l174.947-106.576c4.657-2.836 7.556-7.986 7.565-13.44.01-5.453-2.87-10.615-7.517-13.469z",fill:"#fff"}})]))}}},"85ec":function(t,e,n){},aa09:function(t,e,n){"use strict";n("b2b6")},b2b6:function(t,e,n){},e3c1:function(t,e,n){"use strict";(function(t){n("4160"),n("d81d"),n("b64b"),n("d3b7"),n("25f0"),n("159b");var s=n("9490"),r=n("f206"),a=108,i=[{start:0,end:7500,from:"ffffffffff00",to:"ffffffffff00",animated:!1,fade:500},{start:7500,end:29850,from:"ffffffffff00",to:"00000000ff00",animated:!0,fade:500},{start:29850,end:3e4,from:"000000000000",to:"000000000000",animated:!0,fade:500},{start:3e4,end:30025,from:"000000000000",to:"ffffffffff00",animated:!1,fade:500},{start:3e4,end:30050,from:"000000000000",to:"ffffffffff00",animated:!1,fade:500},{start:3e4,end:30075,from:"ffffffffff00",to:"000000000000",animated:!1,fade:500},{start:30075,end:46500,from:"ffffffffff00",to:"00000000ff00",animated:!0,fade:500},{start:46500,end:48e3,from:"00000000ff00",to:"00000000ff00",animated:!0,fade:500},{start:48e3,end:54e3,from:"00000000ff00",to:"00000000ffff",animated:!0,fade:500},{start:54e3,end:63e3,from:"00000000ffff",to:"00000000aaee",animated:!0,fade:500},{start:63e3,end:67500,from:"00000000aaee",to:"0000000000ff",animated:!1,fade:500},{start:67500,end:72e3,from:"0000000000ff",to:"0000000000ff",animated:!1,fade:500},{start:72e3,end:79350,from:"0000000000ff",to:"550000550055",animated:!0,fade:500},{start:79350,end:79500,from:"000000000000",to:"000000000000",animated:!0,fade:500},{start:79500,end:79525,from:"000000000000",to:"bbbbbbbbbb00",animated:!1,fade:500},{start:79500,end:79550,from:"000000000000",to:"bbbbbbbbbb00",animated:!1,fade:500},{start:79500,end:79575,from:"bbbbbbbbbb00",to:"000000000000",animated:!1,fade:500},{start:79575,end:87e3,from:"bbbbbbbbbb00",to:"ff00005500ff",animated:!0,fade:500},{start:87e3,end:90025,from:"ff00005500ff",to:"ff00005500ff",animated:!0,fade:500}];e["a"]={name:"DMXSender",components:{},data:function(){return{clock:null,delta:0,start:Date.now(),frame:0,leds:new Array(a),lruThreshold:6,lruLEDs:new r,lastLED:0,colorStart:"ffffffffff00",animations:[],keyframes:i}},methods:{map:function(t,e,n,s,r){return(t-e)*(r-s)/(n-e)+s},intToHex:function(t){var e=Math.round(t).toString(16);return 1==e.length&&(e="0"+e),e},parseRGB:function(t){return t.substring(0,6)},parseWAUV:function(t){return t.substring(6,12)},blendColors:function(t,e,n){if(t=t||"#000000",e=e||"#ffffff",n=n||.5,4!=t.length&&7!=t.length)throw new Error("colors must be provided as hexes");if(4!=e.length&&7!=e.length)throw new Error("colors must be provided as hexes");if(n>1||n<0)throw new Error("percentage must be between 0 and 1");t=4==t.length?t[1]+t[1]+t[2]+t[2]+t[3]+t[3]:t.substring(1),e=4==e.length?e[1]+e[1]+e[2]+e[2]+e[3]+e[3]:e.substring(1),t=[parseInt(t[0]+t[1],16),parseInt(t[2]+t[3],16),parseInt(t[4]+t[5],16)],e=[parseInt(e[0]+e[1],16),parseInt(e[2]+e[3],16),parseInt(e[4]+e[5],16)];var s=[(1-n)*t[0]+n*e[0],(1-n)*t[1]+n*e[1],(1-n)*t[2]+n*e[2]];return this.intToHex(s[0])+this.intToHex(s[1])+this.intToHex(s[2])},toogleDMXActive:function(){this.$store.commit("SetDMXActive",!this.$store.state.dmxActive)},init:function(){this.keyframes.forEach((function(t){var e=t.start,n=0;while(e<t.end){var s=this.blendColors("#"+this.parseRGB(t.to),"#"+this.parseRGB(t.from),this.map(n,0,t.end-t.start,1,0)),r=this.blendColors("#"+this.parseWAUV(t.to),"#"+this.parseWAUV(t.from),this.map(n,0,t.end-t.start,1,0));this.animations[e]={color:s+r,running:t.animated,fade:t.fade},e+=25,n+=25}}),this);var t="all/"+this.colorStart+"/1";this.sendHttpRequest(t)},animate:function(){if(this.$store.state.isPlaying){var t=Date.now()-this.start;return t>this.$store.state.interval&&(this.$store.commit("SetCurrentFrame",this.$store.state.currentFrame+1),this.$store.state.currentFrame>=Object.keys(this.$store.state.currentJSONData["red"].positions).length*this.$store.state.fps)?(this.$store.commit("SetAnimationStatus",!1),this.$store.commit("SetCurrentFrame",0),void this.clear()):void 0}},update:function(t,e,n){var s=this,r=this.$store.state;if(r.currentJSONData[t]){var a=r.currentJSONData[t].positions[e];void 0!==a&&a.forEach((function(t){s.lruLEDs.enqueue(t),s.lruLEDs.size()>s.lruThreshold&&s.lruLEDs.dequeue(),s.leds[t-2]=30,s.leds[t-1]=0,s.leds[t]=0,s.leds[t+1]=0,s.leds[t+2]=30}))}},clear:function(){for(var t=0;t<this.leds.length;t++)this.leds[t]=100},send:function(t,e){var n=this.$store.state;if(n.currentJSONData["red"])for(var s=1;s<=this.leds.length;s++)if(this.animations[t].running){var r=this.leds[s-1];if(r<100){var a=this.blendColors("#"+this.parseRGB(this.animations[t].color),"#000000",this.map(r,0,100,1,0)),i=this.blendColors("#"+this.parseWAUV(this.animations[t].color),"#000000",this.map(r,0,100,1,0)),o=(this.animations[t].fade,s+"/"+a+i+"/500");this.sendHttpRequest(o)}else{o=s+"/"+this.animations[t].color+"/500";this.sendHttpRequest(o)}}else{o=s+"/"+this.animations[t].color+"/500";this.sendHttpRequest(o)}},process:function(){if(this.$store.state.dmxActive){var t=this.$store.state,e=t.currentFrame,n="red",s=Object.keys(t.currentJSONData[n].positions).length*t.fps;if(t.currentJSONData[n]){var r=t.currentJSONData[n].positions[e];void 0!==r&&(this.clear(),this.update("red",e,s),this.send(e,s))}}},sendHttpRequest:function(e){var n={hostname:"192.168.1.200",port:3e3,path:"/"+e,method:"GET"},r=s.request(n,(function(e){e.on("data",(function(e){t.stdout.write(e)}))}));r.on("error",(function(t){console.error(t)})),r.end()},checkServerStatus:function(){var t=this,e={hostname:"192.168.1.200",port:3e3,path:"/",method:"GET"},n=s.request(e,(function(e){t.$store.commit("SetDMXConnected",!0)}));n.on("error",(function(e){console.error(e),console.log("Server not reachable..."),t.$store.commit("SetDMXConnected",!1)})),n.end()},togglePlay:function(t){"Space"==t.code&&(this.$store.state.isPlaying?this.$store.commit("SetAnimationStatus",!1):this.$store.commit("SetAnimationStatus",!0))},directOff:function(){this.sendHttpRequest("all/000000000000/1")},directWhite:function(){this.sendHttpRequest("all/ffffffffff00/1")}},mounted:function(){var t=this;this.init(),this.checkServerStatus(),setInterval(function(){this.animate()}.bind(this),1e3/this.$store.state.fps),this.$store.watch((function(t){return t.currentFrame}),(function(e,n){return t.process()}))},created:function(){window.addEventListener("keypress",this.togglePlay)},destroyed:function(){window.removeEventListener("keypress",this.togglePlay)}}}).call(this,n("4362"))},f87c:function(t,e){t.exports={functional:!0,render(t,e){const{_c:n,_v:s,data:r,children:a=[]}=e,{class:i,staticClass:o,style:f,staticStyle:c,attrs:l={},...u}=r;return n("svg",{class:[i,o],style:[f,c],attrs:Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 473.931 473.931"},l),...u},a.concat([n("circle",{attrs:{cx:"236.966",cy:"236.966",r:"236.966",fill:"#f28400"}}),n("path",{attrs:{d:"M324.149 147.755c0-6.514-5.283-11.801-11.802-11.801h-45.646c-6.526 0-11.809 5.287-11.809 11.801v116.713l69.256-69.26v-47.453z",fill:"#eca448"}}),n("g",{attrs:{fill:"#fff"}},[n("path",{attrs:{d:"M324.149 326.151c0 6.518-5.283 11.802-11.802 11.802h-45.646c-6.526 0-11.809-5.283-11.809-11.802V147.755c0-6.514 5.283-11.801 11.809-11.801h45.646c6.518 0 11.802 5.287 11.802 11.801v178.396zM219.016 326.151c0 6.518-5.283 11.802-11.802 11.802h-45.657c-6.518 0-11.802-5.283-11.802-11.802V147.755c0-6.514 5.283-11.801 11.802-11.801h45.653c6.518 0 11.801 5.287 11.801 11.801v178.396h.005z"}})])]))}}},f884:function(t,e,n){},ff2b:function(t,e,n){"use strict";n("0796")},ff71:function(t,e,n){}});
//# sourceMappingURL=app.8a3f7bad.js.map